<!-- /Public/Base.html 〈修正後：フラグメント〉 -->
<header>
  <style>
    :root{ --header-h:64px; --text:#e6f1ff; --muted:#b8c6e0; --bg:rgba(10,16,30,.85); }
    *{box-sizing:border-box}
    header{position:sticky; top:0; z-index:1000;
      background:linear-gradient(180deg,var(--bg),rgba(10,16,30,.55));
      border-bottom:1px solid rgba(255,255,255,.06)}
    .wrap{max-width:1200px; margin:0 auto; padding:0 12px}
    .nav{display:flex; align-items:center; width:100%; gap:.6rem; height:var(--header-h)}
    .brand{display:inline-flex; align-items:center; gap:.55rem; font-weight:900; letter-spacing:.02em}
    .sp{flex:1}
    .navlinks{display:flex; gap:.25rem; align-items:center}
    .link{color:var(--text); text-decoration:none; padding:.45rem .7rem; border-radius:10px}
    .link:hover{background:rgba(255,255,255,.06)}
    .btn{display:inline-flex; align-items:center; gap:.4rem; padding:.5rem .8rem; border-radius:10px;
         border:1px solid rgba(255,255,255,.12); background:transparent; color:var(--text);
         text-decoration:none; font-weight:700}
    .btn.primary{border:none; background:linear-gradient(180deg,#00bcd4,#2196f3); color:#fff}
    @media (max-width:900px){ .navlinks{display:none} }
  </style>

  <div class="nav wrap" style="padding-left:0;padding-right:0">
    <div class="brand">
      <svg width="26" height="26" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M12 2l2.39 4.84 5.34.78-3.86 3.76.91 5.31L12 14.77 7.22 16.69l.91-5.31L4.27 7.62l5.34-.78L12 2z" fill="currentColor" opacity=".95"/>
      </svg>
      <span>MCML</span>
    </div>

    <div class="sp"></div>

    <nav class="navlinks">
      <a class="link" href="/">ホーム</a>
      <a class="link" href="/Admin/admin.html">管理Doc</a>
    </nav>

    <div id="welcome" class="link" style="display:none; font-weight:700; margin-left:8px;"></div>
    <a id="loginBtn" class="btn primary" href="/auth/discord/login" style="margin-left:8px">ログイン</a>
    <a id="logoutBtn" class="btn" href="/auth/logout" style="display:none; margin-left:8px">ログアウト</a>
  </div>

  <script>
    // /auth/me でセッション確認 → ヘッダー表示切替
    (async ()=>{
      try{
        const res = await fetch("/auth/me", {credentials:"include"});
        if(!res.ok) return;
        const me = await res.json();
        if(me && me.ok){
          const name = me.global_name || me.username || "";
          const w = document.getElementById("welcome");
          w.textContent = name ? `ようこそ ${name} さん` : "ログイン中";
          w.style.display = "inline-flex";
          document.getElementById("loginBtn").style.display = "none";
          document.getElementById("logoutBtn").style.display = "inline-flex";
        }
      }catch(_e){}
    })();
  </script>
</header>
