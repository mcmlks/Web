<!-- /Admin/index.html -->
<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>MCML 管理ハンドブック（Admin）</title>
<meta name="description" content="MCML 管理者向けハンドブック。役職別の業務内容、運営ルール、Minecraft管理コマンド、CoreProtectの使い方など。">
<meta name="color-scheme" content="light dark">
<style>
/* ================= Theme / Layout ================= */
/* デフォルトはダーク基調。白系の混色を避け、一定のコントラストに固定 */
:root{
  color-scheme: dark;
  --bg:#0b1020; --panel:#11182b; --panel2:#0d1527; --line:#19243e;
  --text:#e5e7eb; --muted:#9aa4b2; --brand:#22d3ee; --ok:#34d399; --warn:#fde047; --danger:#ef4444;
  --radius:16px; --shadow:0 10px 28px rgba(0,0,0,.35);
  --max:1180px; --side:280px;
  --elev-1:rgba(255,255,255,.04);  /* 軽い面 */
  --elev-2:rgba(255,255,255,.06);  /* 見出し・ボタン */
  --elev-3:rgba(255,255,255,.08);  /* 枠線や強調 */
}
@media (prefers-color-scheme: light){
  :root{
    color-scheme: light;
    --bg:#f6f8fb; --panel:#f1f5f9; --panel2:#ffffff; --line:#e1e7ef;
    --text:#0b1320; --muted:#55647a;
    --elev-1:rgba(0,0,0,.03);
    --elev-2:rgba(0,0,0,.05);
    --elev-3:rgba(0,0,0,.08);
    --shadow:0 10px 22px rgba(2,6,23,.08);
  }
}
*{box-sizing:border-box}
html,body{height:100%}
html{background-color:var(--bg)} /* 一瞬の白フラッシュを防止 */
body{
  margin:0; font: 15px/1.75 system-ui, -apple-system, Segoe UI, Inter, Roboto,
  "Noto Sans JP","Hiragino Kaku Gothic ProN","Meiryo", sans-serif;
  color:var(--text);
  background:
    radial-gradient(1000px 520px at 10% -10%, rgba(34,211,238,.10), transparent 60%),
    radial-gradient(1000px 520px at 90% -20%, rgba(52,211,153,.08), transparent 60%),
    var(--bg);
}
a{color:inherit; text-decoration:none}
code,pre,.code{font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Noto Sans JP", monospace}
kbd{font:600 12px ui-monospace; background:var(--elev-2); padding:2px 6px; border-radius:6px}

/* ===== Header（外部 Base.html を使う） ===== */
header{
  position:sticky; top:0; z-index:50;
  backdrop-filter:saturate(120%) blur(10px);
  background:rgba(8,12,24,.72);
  border-bottom:1px solid var(--line);
}
@media (prefers-reduced-transparency: reduce){
  header{backdrop-filter:none; background:rgba(8,12,24,.95)}
}

/* ===== Page ===== */
.wrap{max-width:var(--max); margin:0 auto; display:grid; grid-template-columns: var(--side) 1fr; gap:18px; padding:22px}
@media (max-width: 980px){ .wrap{grid-template-columns:1fr} nav.sidenav{position:static; top:auto} }
.card{
  background:linear-gradient(180deg,var(--panel),var(--panel2));
  border:1px solid var(--line); border-radius:var(--radius); box-shadow:var(--shadow)
}
.card>.inner{padding:18px 20px}
.h1{font-size: clamp(24px, 3.6vw, 34px); font-weight:900; margin:0 0 6px}
.lead{color:var(--muted); margin:6px 0 0}
.h2{font-size: clamp(18px, 2.6vw, 24px); margin:0 0 8px; font-weight:900}
.h3{font-size: 16px; margin:0 0 6px; font-weight:800}
.badge{
  display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border-radius:999px;
  border:1px solid var(--line); background:var(--elev-1);
  font-weight:700; font-size:12px; color:var(--muted)
}
.grid{display:grid; gap:12px}
.cols-2{grid-template-columns:1fr 1fr} .cols-3{grid-template-columns:repeat(3,1fr)}
@media (max-width: 900px){ .cols-2,.cols-3{grid-template-columns:1fr} }

/* ===== Sidenav ===== */
nav.sidenav{position:sticky; top:70px; align-self:start}
nav.sidenav .inner{position:sticky; top:70px}
nav.sidenav a{display:block; padding:8px 10px; border-radius:10px}
nav.sidenav a:hover{background:var(--elev-2)}
nav.sidenav .sec{font-weight:800; margin-top:6px}

/* ===== Details（白飛び対策：白混色→低輝度の面色） ===== */
details{
  border:1px solid var(--line); border-radius:12px; overflow:hidden;
  background:var(--elev-1)
}
summary{
  cursor:pointer; padding:10px 12px; font-weight:800;
  background:var(--elev-2)
}
details .content{padding:12px 14px}
summary .tag{
  font:700 11px/1 ui-sans-serif; padding:6px 8px; border-radius:999px;
  border:1px solid var(--line); margin-left:8px; color:var(--muted);
  background:var(--elev-1)
}

/* ===== Tables ===== */
.table{width:100%; border-collapse: collapse; font-size:14px}
.table th,.table td{border-top:1px dashed var(--line); padding:8px 10px; vertical-align:top}
.table th{white-space:nowrap; color:var(--muted); text-align:left}

/* ===== Code blocks ===== */
pre{
  margin:8px 0; padding:12px 14px;
  background:#0c1426; border:1px solid #14223f; border-radius:10px; overflow:auto
}
.copy{
  float:right; font-size:12px; padding:4px 8px; border-radius:8px;
  border:1px solid var(--line); background:var(--elev-2); cursor:pointer
}
.hl{color:#93c5fd}

/* ===== Search ===== */
#cmdSearch{
  width:100%; padding:10px 12px; border-radius:12px;
  border:1px solid var(--line); background:var(--elev-1); color:var(--text)
}

/* ===== Footer ===== */
footer{padding:24px; color:var(--muted); border-top:1px dashed var(--line); margin-top:18px}
</style>
</head>
<body>

<!-- 共通ヘッダー -->
<!--#include "/Public/Base.html" -->

<main class="wrap">
  <!-- ===== Side Nav ===== -->
  <nav class="sidenav card">
    <div class="inner">
      <div class="badge">MCML Admin</div>
      <a class="sec" href="#roles">① 役職別の業務</a>
      <a href="#ops">運営ルール / 連絡</a>
      <a class="sec" href="#mc-commands">② 管理コマンド基礎</a>
      <a href="#coreprotect">CoreProtect 実践</a>
      <a href="#cheatsheet">チートシート</a>
    </div>
  </nav>

  <!-- ===== Content ===== -->
  <section class="content">
    <article class="card">
      <div class="inner">
        <h1 class="h1">管理ハンドブック</h1>
        <p class="lead">このページは<strong>管理者アカウントのみ</strong>に公開されています<strong></strong></p>
      </div>
    </article>

    <!-- ① 役職別の業務 -->
    <article id="roles" class="card">
      <div class="inner">
        <span class="badge">① 役職別の業務</span>
        <h2 class="h2" style="margin-top:6px">役割と責任</h2>
        <div class="grid cols-2">
          <div>
            <h3 class="h3">オーナー（Owner）</h3>
            <ul>
              <li>運営方針の決定、最終承認</li>
              <li>重要インシデントのエスカレーション受け</li>
              <li>法務・規約更新（配布物ライセンス等）</li>
              <li>機密情報の管理（トークン、バックアップ鍵）</li>
            </ul>
          </div>
          <div>
            <h3 class="h3">管理者（Admin）</h3>
            <ul>
              <li>サーバー運用（起動/停止/バックアップ）</li>
              <li>プラグイン更新・設定管理（GitHub PR レビュー）</li>
              <li>重大荒らし対応（CoreProtect ロールバック、Ban）</li>
              <li>モデレーターのサポートと教育</li>
            </ul>
          </div>
          <div>
            <h3 class="h3">モデレーター（Moderator）</h3>
            <ul>
              <li>チャット/VCの監視と注意・Mute・Kick</li>
              <li>通報受付・一次トリアージ（証跡の確保）</li>
              <li>軽度の破壊行為の補修、プレイヤー支援</li>
              <li>コミュニティイベントの進行補助</li>
            </ul>
          </div>
          <div>
            <h3 class="h3">テクニカル（Ops/Dev）</h3>
            <ul>
              <li>自動バックアップ・監視・スケジューリング</li>
              <li>CI/CD（GitHub → 配布/設定反映）の整備</li>
              <li>パフォーマンス最適化（TPS/プロファイル）</li>
              <li>セキュリティ（ポート/権限/ログ）と災害復旧計画</li>
            </ul>
          </div>
        </div>

        <h3 id="ops" class="h3" style="margin-top:14px">運営ルール / 連絡</h3>
        <table class="table">
          <tr><th>連絡窓口</th><td>緊急時は管理者Discordチャンネルへ。重大事案は @Owner をメンション。</td></tr>
          <tr><th>インシデント</th><td>証跡を残す（スクショ・動画・/co lookup 結果）。復旧前に必ず現状記録。</td></tr>
          <tr><th>変更管理</th><td>設定/サイトは GitHub で PR。コミットメッセージに変更理由・影響範囲を明記。</td></tr>
          <tr><th>秘密情報</th><td>クライアントID/Secret は <code>config.json</code> 管理。HTML/JS には絶対埋め込まない。</td></tr>
        </table>
      </div>
    </article>

    <!-- ② 管理コマンド基礎 -->
    <article id="mc-commands" class="card">
      <div class="inner">
        <span class="badge">② サーバ管理コマンド基礎</span>
        <h2 class="h2" style="margin-top:6px">よく使うMinecraftコマンド</h2>

        <input id="cmdSearch" type="search" placeholder="コマンドを検索（例: whitelist, ban, op, time）" style="margin:8px 0 10px">

        <details open>
          <summary>/op, /deop <span class="tag">権限</span></summary>
          <div class="content">
            <pre><button class="copy" data-copy="/op <player>">コピー</button>/op &lt;player&gt;
/deop &lt;player&gt;</pre>
            <p class="muted">OP 付与/剥奪。乱用防止のため付与は最小限に。</p>
          </div>
        </details>

        <details>
          <summary>/whitelist <span class="tag">アクセス</span></summary>
          <div class="content">
            <pre><button class="copy" data-copy="/whitelist add <name>">コピー</button>/whitelist add &lt;name&gt;
 /whitelist remove &lt;name&gt;
 /whitelist on
 /whitelist off</pre>
            <p class="muted">イベント時などに使用。リストはバックアップしておく。</p>
          </div>
        </details>

        <details>
          <summary>/ban, /pardon <span class="tag">秩序</span></summary>
          <div class="content">
            <pre><button class="copy" data-copy="/ban <name> [reason]">コピー</button>/ban &lt;name&gt; [reason]
/ban-ip &lt;address&gt;
 /pardon &lt;name&gt;
 /pardon-ip &lt;address&gt;</pre>
            <p class="muted">悪質行為にはスクショとログを残し、理由を添えて処置。</p>
          </div>
        </details>

        <details>
          <summary>/broadcast, /say <span class="tag">告知</span></summary>
          <div class="content">
            <pre><button class="copy" data-copy="/broadcast <>">コピー</button>/broadcast &lt;message&gt;
/say &lt;message&gt;</pre>
          </div>
        </details>

        <details>
          <summary>/tp, /gamemode など</summary>
          <div class="content">
            <pre>/tp &lt;target&gt; &lt;x y z&gt;  /tp &lt;player&gt; &lt;toPlayer&gt;
 /gamemode survival|creative|adventure|spectator &lt;player&gt;
 /time set day|night  /weather clear|rain|thunder</pre>
          </div>
        </details>
      </div>
    </article>

    <!-- CoreProtect 実践 -->
    <article id="coreprotect" class="card">
      <div class="inner">
        <span class="badge">CoreProtect 実践</span>
        <h2 class="h2" style="margin-top:6px">荒らし対策・復旧ワークフロー</h2>

        <p class="muted">基本の流れ：<b>証跡確保 → 調査（/co i, /co l）→ 影響範囲の特定 → ロールバック（/co rb）→ 検証 → 解除/報告</b></p>

        <details open>
          <summary>① インスペクト（現地確認） <span class="tag">/co inspect</span></summary>
          <div class="content">
            <pre><button class="copy" data-copy="/co inspect">コピー</button>/co inspect   （短縮: /co i）
/co inspect off</pre>
            <ul>
              <li>ブロックを左/右クリックして履歴を確認。</li>
              <li>看板・チェスト・かまど・額縁なども履歴が出ます。</li>
            </ul>
          </div>
        </details>

        <details>
          <summary>② 変更の検索（lookup） <span class="tag">/co l</span></summary>
          <div class="content">
            <pre><button class="copy" data-copy='/co l u:Player t:24h r:20 a:+block +container'>コピー</button>/co lookup u:&lt;player&gt; t:&lt;期間&gt; r:&lt;半径&gt; a:&lt;アクション&gt;
短縮: /co l u:Steve t:24h r:20 a:+block +container</pre>
            <table class="table">
              <tr><th>u:</th><td>ユーザー名（複数可）。<code>-user</code>で除外。</td></tr>
              <tr><th>t:</th><td>時間。例 <code>1h</code>, <code>24h</code>, <code>7d</code>.</td></tr>
              <tr><th>r:</th><td>半径（現在位置中心）。未指定で広範囲検索。</td></tr>
              <tr><th>a:</th><td>アクション。<code>+block</code>（設置/破壊）、<code>+container</code>（チェスト出し入れ）等。</td></tr>
            </table>
            <p class="muted">結果が多いときは <code>page:&lt;数&gt;</code> でページ送り。</p>
          </div>
        </details>

        <details>
          <summary>③ ロールバック / 復元 <span class="tag">/co rb, /co rs</span></summary>
          <div class="content">
            <pre><button class="copy" data-copy="/co rollback u:Steve t:1h r:15">コピー</button>/co rollback u:&lt;player&gt; t:&lt;期間&gt; r:&lt;半径&gt;
（取り消し）/co restore u:&lt;player&gt; t:&lt;期間&gt; r:&lt;半径&gt;</pre>
            <ul>
              <li><b>まず小さな半径で試す</b>（例: r:10〜20）。</li>
              <li>チェスト窃盗は <code>a:container</code> を指定して対象を絞ると安全。</li>
              <li>誤操作時は直ちに <code>/co rs</code>（restore）で元に戻す。</li>
            </ul>
          </div>
        </details>

        <details>
          <summary>④ 補助コマンド</summary>
          <div class="content">
            <pre>/co near r:&lt;半径&gt;        （近くの変更を一覧）
/co teleport &lt;id&gt;        （lookup 結果の座標へTP）
/co purge t:&lt;期間&gt;        （古いログを削除・計画的に）</pre>
          </div>
        </details>

        <details>
          <summary>よくある失敗と回避</summary>
          <div class="content">
            <ul>
              <li><b>広範囲rbで巻き戻し過多</b> → 先に <code>r</code> を小さく、<code>u</code> と <code>a</code> で絞る。</li>
              <li><b>看板/額縁の消失</b> → <code>a:block +item</code> を含めて検索し、必要なら個別復元。</li>
              <li><b>ログ不足</b> → <code>config</code> の <code>consumer</code>/<code>logger</code> 設定と保存期間を確認。</li>
            </ul>
          </div>
        </details>
      </div>
    </article>

    <!-- チートシート -->
    <article id="cheatsheet" class="card">
      <div class="inner">
        <span class="badge">CoreProtect チートシート</span>
        <div class="grid cols-2" style="margin-top:8px">
          <div>
            <h3 class="h3">検索テンプレ</h3>
            <pre><button class="copy" data-copy="/co l u:NAME t:24h r:15 a:+block +container">コピー</button>/co l u:NAME t:24h r:15 a:+block +container
/co l u:!trusted t:2h r:20 a:+block</pre>
          </div>
          <div>
            <h3 class="h3">復旧テンプレ</h3>
            <pre><button class="copy" data-copy="/co rb u:NAME t:1h r:10 a:container">コピー</button>/co rb u:NAME t:1h r:10 a:container
/co rs u:NAME t:1h r:10</pre>
          </div>
        </div>
      </div>
    </article>

    <footer class="card"><div class="inner">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap">
        <span class="muted">© <span id="year"></span> MCML Admin</span>
        <a class="badge" href="/Public/index.html">← 公開サイトへ戻る</a>
      </div>
    </div></footer>
  </section>
</main>

<script>
/* 年表示 */
document.getElementById('year').textContent = new Date().getFullYear();

/* コマンド検索フィルタ */
const search = document.getElementById('cmdSearch');
search.addEventListener('input', () => {
  const q = search.value.trim().toLowerCase();
  document.querySelectorAll('#mc-commands details').forEach(d => {
    if (!q){ d.style.display=''; d.open = d.hasAttribute('open'); return; }
    const txt = d.textContent.toLowerCase();
    const hit = txt.includes(q);
    d.style.display = hit ? '' : 'none';
    d.open = hit;
  });
});

/* コードコピー */
document.addEventListener('click', e=>{
  const btn = e.target.closest('.copy'); if(!btn) return;
  const text = btn.dataset.copy || btn.parentElement.textContent;
  navigator.clipboard.writeText(text).then(()=>{
    btn.textContent = 'コピー済み ✔'; setTimeout(()=> btn.textContent='コピー', 1200);
  });
});
</script>
</body>
</html>
